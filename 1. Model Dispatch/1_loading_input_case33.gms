$ontext
parameter Pd(b)  *MW
/
b1	0
b2	0.1
b3	0.09
b4	0.12
b5	0.06
b6	0.06
b7	0.2
b8	0.2
b9	0.06
b10	0.06
b11	0.045
b12	0.06
b13	0.06
b14	0.12
b15	0.06
b16	0.06
b17	0.06
b18	0.09
b19	0.09
b20	0.09
b21	0.09
b22	0.09
b23	0.09
b24	0.42
b25	0.42
b26	0.06
b27	0.06
b28	0.06
b29	0.12
b30	0.2
b31	0.15
b32	0.21
b33	0.06
/;

parameter Qd(b)  *MVAR
/
b1	0
b2	0.06
b3	0.04
b4	0.08
b5	0.03
b6	0.02
b7	0.1
b8	0.1
b9	0.02
b10	0.02
b11	0.03
b12	0.035
b13	0.035
b14	0.08
b15	0.01
b16	0.02
b17	0.02
b18	0.04
b19	0.04
b20	0.04
b21	0.04
b22	0.04
b23	0.05
b24	0.2
b25	0.2
b26	0.025
b27	0.025
b28	0.02
b29	0.07
b30	0.6
b31	0.07
b32	0.1
b33	0.04
/;

parameter Gs(b)
/
b1	0
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0
b19	0
b20	0
b21	0
b22	0
b23	0
b24	0
b25	0
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0
/;

*Bs: b18 0 MVAr for meshed and 0.4 MVAr (capacitive) for radial
*Bs: b33 0 MVAr for meshed and 0.6 MVAr (capacitive) for radial
parameter Bs(b)  *MVAR
/
b1	0
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0   
b20	0
b21	0
b22	0
b23	0
b24	0
b25	0
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0  
/;
*p.u.
* b1  *1.05
parameter Vmax(b)  
/
b1	1          
b2	1.05
b3	1.05
b4	1.05
b5	1.05
b6	1.05
b7	1.05
b8	1.05
b9	1.05
b10	1.05
b11	1.05
b12	1.05
b13	1.05
b14	1.05
b15	1.05
b16	1.05
b17	1.05
b18	1.05
b19	1.05
b20	1.05
b21	1.05
b22	1.05
b23	1.05
b24	1.05
b25	1.05
b26	1.05
b27	1.05
b28	1.05
b29	1.05
b30	1.05
b31	1.05
b32	1.05
b33	1.05
/;

*p.u. b1 *0.95
parameter Vmin(b)  
/
b1	1         
b2	0.95
b3	0.95
b4	0.95
b5	0.95
b6	0.95
b7	0.95
b8	0.95
b9	0.95
b10	0.95
b11	0.95
b12	0.95
b13	0.95
b14	0.95
b15	0.95
b16	0.95
b17	0.95
b18	0.95
b19	0.95
b20	0.95
b21	0.95
b22	0.95
b23	0.95
b24	0.95
b25	0.95
b26	0.95
b27	0.95
b28	0.95
b29	0.95
b30	0.95
b31	0.95
b32	0.95
b33	0.95
/;

*degree *-5
parameter angmin(b) 
/
b1	0         
b2	-360
b3	-360
b4	-360
b5	-360
b6	-360
b7	-360
b8	-360
b9	-360
b10	-360
b11	-360
b12	-360
b13	-360
b14	-360
b15	-360
b16	-360
b17	-360
b18	-360
b19	-360
b20	-360
b21	-360
b22	-360
b23	-360
b24	-360
b25	-360
b26	-360
b27	-360
b28	-360
b29	-360
b30	-360
b31	-360
b32	-360
b33	-360
/;

*degree b1 5
parameter angmax(b) 
/
b1	0        
b2	360
b3	360
b4	360
b5	360
b6	360
b7	360
b8	360
b9	360
b10	360
b11	360
b12	360
b13	360
b14	360
b15	360
b16	360
b17	360
b18	360
b19	360
b20	360
b21	360
b22	360
b23	360
b24	360
b25	360
b26	360
b27	360
b28	360
b29	360
b30	360
b31	360
b32	360
b33	360
/;

*MW
*b18 *Very High Renewable Generation: Pgenmax 0.8
*b22 *Very High Renewable Generation: Pgenmax 0.8
*b25 *Very High Renewable Generation: Pgenmax 0.8
*b33 *Very High Renewable Generation: Pgenmax 0.8
parameter Pgenmax(b)  
/
b1	4
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0.2 
b19	0
b20	0
b21	0
b22	0.2 
b23	0
b24	0
b25	0.2 
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0.2 
/;


*MW
parameter Pgenmin(b)  
/
b1	0
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0
b19	0
b20	0
b21	0
b22	0
b23	0
b24	0
b25	0
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0
/;

*MVAR
parameter Qgenmax(b)  
/
b1	2.5
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0
b19	0
b20	0
b21	0
b22	0
b23	0
b24	0
b25	0
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0
/;


*MVAR
parameter Qgenmin(b)  
/
b1	-2.5
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0
b19	0
b20	0
b21	0
b22	0
b23	0
b24	0
b25	0
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0
/;

parameter Genstatus(b)
/
b1	1
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	1
b19	0
b20	0
b21	0
b22	1
b23	0
b24	0
b25	1
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	1
/;

*($/MW^2h)
parameter costcoeffA 
/
b1	0.003
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	0.0026
b19	0
b20	0
b21	0
b22	0.0026
b23	0
b24	0
b25	0.0026
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	0.0026
/;

*($/MWh)
parameter costcoeffB 
/
b1	12
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	10.26
b19	0
b20	0
b21	0
b22	10.26
b23	0
b24	0
b25	10.26
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33	10.26
/;

*($/h)
parameter costcoeffC 
/
b1	240
b2	0
b3	0
b4	0
b5	0
b6	0
b7	0
b8	0
b9	0
b10	0
b11	0
b12	0
b13	0
b14	0
b15	0
b16	0
b17	0
b18	210
b19	0
b20	0
b21	0
b22	210
b23	0
b24	0
b25	210
b26	0
b27	0
b28	0
b29	0
b30	0
b31	0
b32	0
b33 210
/
;


*Ohm
parameter r(l) 
/
l1	0.0922
l2	0.493
l3	0.366
l4	0.3811
l5	0.819
l6	0.1872
l7	0.7114
l8	1.03
l9	1.044
l10	0.1966
l11	0.3744
l12	1.468
l13	0.5416
l14	0.591
l15	0.7463
l16	1.289
l17	0.732
l18	0.164
l19	1.5042
l20	0.4095
l21	0.7089
l22	0.4512
l23	0.898
l24	0.896
l25	0.203
l26	0.2842
l27	1.059
l28	0.8042
l29	0.5075
l30	0.9744
l31	0.3105
l32	0.341
l33	2
l34	2
l35	0.5
/;

*Ohm
parameter x(l) 
/
1	0.047
2	0.2511
3	0.1864
4	0.1941
5	0.707
6	0.6188
7	0.2351
8	0.74
9	0.74
10	0.065
11	0.1238
12	1.155
13	0.7129
14	0.526
15	0.545
16	1.721
17	0.574
18	0.1565
19	1.3554
20	0.4784
21	0.9373
22	0.3083
23	0.7091
24	0.7011
25	0.1034
26	0.1447
27	0.9337
28	0.7006
29	0.2585
30	0.963
31	0.3619
32	0.5302
33	2
34	2
35	0.5
/;

*l33 Linestatus: 0 for radial and 1 for meshed
*l34 Linestatus: 0 for radial and 1 for meshed
*l35 Linestatus: 0 for radial and 1 for meshed
parameter Linestatus(l)
/
1	1
2	1
3	1
4	1
5	1
6	1
7	1
8	1
9	1
10	1
11	1
12	1
13	1
14	1
15	1
16	1
17	1
18	1
19	1
20	1
21	1
22	1
23	1
24	1
25	1
26	1
27	1
28	1
29	1
30	1
31	1
32	1
33	0  
34	0  
35	0  
/;

Table MP_DH(t,*)
    price            
1	25.02
2	18.29
3	16.04
4	14.60
5	14.95
6	14.50
7	10.76
8	12.01
9	12.39
10	14.04
11	14.68
12	16.08
13	16.08
14	16.05
15	16.04
16	16.10
17	23.93
18	26.90
19	26.36
20	23.98
21	16.09
22	14.08
23	12.44
24	0.04
25	-12.11
26	-19.63
27	-19.37
28	-31.41
29	-46.97
30	-13.48
31	0.08
32	10.06
33	14.25
34	14.56
35	14.64
36	15.08
37	15.41
38	14.52
39	14.70
40	14.66
41	16.09
42	25.10
43	25.06
44	19.08
45	14.26
46	12.22
47	10.40
48	-0.33
49	-0.08
50	-0.07
51	-5.03
52	0.01
53	-0.04
54	0.03
55	-8.67
56	4.46
57	9.90
58	14.29
59	16.73
60	22.31
61	23.03
62	22.40
63	27.07
64	29.33
65	33.85
66	45.96
67	49.82
68	47.62
69	35.98
70	27.26
71	27.70
72	14.27
73	9.32
74	0.02
75	-0.04
76	0.01
77	0.00
78	-0.01
79	-3.18
80	-0.05
81	0.05
82	9.62
83	11.54
84	14.68
85	14.31
86	11.18
87	12.01
88	14.36
89	17.55
90	28.94
91	29.59
92	29.42
93	28.92
94	28.66
95	29.74
96	24.90
;

Table MP_DH(t,*)
    price            
1   25.02
2   18.29
3   16.04
4   14.60
5   14.95
6   14.50
7   10.76
8   12.01
9   12.39
10  14.04
11  14.68
12  16.08
13  16.08
14  16.05
15  16.04
16  16.10
17  23.93
18  26.90
19  26.36
20  23.98
21  16.09
22  14.08
23  12.44
24  10.23
25  14.25
26  14.56
27  15.41
28  12.22
29  16.09
30  26.90
31  14.25
32  10.06
33  14.25
34  14.56
35  14.64
36  15.08
37  15.41
38  14.52
39  14.70
40  14.66
41  16.09
42  25.10
43  25.06
44  19.08
45  14.26
46  12.22
47  10.40
48  9.32
49  16.73
50  16.73
51  16.73
52  16.73
53  16.73
54  16.73
55  16.73
56  9.90
57  9.90
58  14.29
59  16.73
60  22.31
61  23.03
62  22.40
63  27.07
64  29.33
65  33.85
66  45.96
67  49.82
68  47.62
69  35.98
70  27.26
71  27.70
72  14.27
73  9.32
74  11.54
75  11.54
76  11.54
77  11.54
78  11.54
79  11.54
80  11.54
81  11.54
82  9.62
83  11.54
84  14.68
85  14.31
86  11.18
87  12.01
88  14.36
89  17.55
90  28.94
91  29.59
92  29.42
93  28.92
94  28.66
95  29.74
96  24.90
;
$offtext
Table GenD(g,*) 'generating units characteristics'

    pmax    pmin    Qmax    Qmin   var
1     4       0      2.5     -2.5   12 
2    0.2      0       0      0      10.26
3    0.2      0       0      0      10.26
4    0.2      0       0      0      10.26
5    0.2      0       0      0      10.26

;

Table GenPV(p,*) 'generating units characteristics'
    pmax 
1    0.2
2    0.2
3    0.2
4    0.2
;

*lines to buses incidence matrix
$ontext
table Alinetobus(l,b)
   b1	b2	b3	b4	b5	b6	b7	b8	b9	b10	b11	b12	b13	b14	b15	b16	b17	b18	b19	b20	b21	b22	b23	b24	b25	b26	b27	b28	b29	b30	b31	b32	b33
l1	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l2	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l3	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l4	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l5	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l6	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l7	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l8	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l9	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l10	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l11	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l12	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l13	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l14	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l15	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l16	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l17	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l18	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0
l19	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0
l20	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0	0
l21	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0	0	0
l22	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0
l23	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0	0
l24	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0	0	0
l25	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0
l26	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0	0
l27	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	0
l28	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0
l29	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0	0
l30	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0	0
l31	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1	0
l32	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	-1
l33	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0
l34	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0
l35	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	-1	0	0	0	0
;
$offtext

Parameter
load_up
load_p(t)
load_q(t)
CF(t)
profil(t)
BP(b)
BQ(b)
Load_bus_p(t,b)
Load_bus_q(t,b)
system_costs
MP_DH(t)
;
$onecho > TEP.txt
par=load_up                        rng=data_case_study!A1:E8761                    rDim=1 cdim=1
par=Load_bus_p                     rng=data_case_study!G2:AN8762                    rDim=1 cdim=1
par=Load_bus_q                     rng=data_case_study!AP2:BW8762                    rDim=1 cdim=1
$offecho
*par=load_up                        rng=data!B16:H112                    rDim=1 cdim=1 winter

$onUNDF
$call   gdxxrw data_case33.xlsx @TEP.txt
$GDXin  data_case33.gdx
$load   load_up, Load_bus_p, Load_bus_q
$GDXin
$offUNDF



load_p(t) = load_up(t,'Active Demand (MW)') /1000
;
load_q(t) = load_up(t,'Reactive Demand (var)')  /1000
;
CF(t)     = load_up(t,'Capacity factor PV')
;
MP_DH(t)  = load_up(t,'Day_ahead_price')
;
Load_bus_p(t,b) =  Load_bus_p(t,b)/1000
;
Load_bus_q(t,b) =  Load_bus_q(t,b)/1000
;
*profil(t) = load_up(t,'profil')
*;
*BP(b)     = bus_up(b,'Pd') 
*;
*BQ(b)     = bus_up(b,'Qd') 
*;
*